<!DOCTYPE html>
<html>
	<head>
		<title>Clarity/ACM CTF 2017</title>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		<link rel="stylesheet" href="pikaday.css">
		<style type="text/css">



		</style>
	</head>
	<body>

		<input type="text" id="datepicker" style="display: none;">
		<div id="container"></div>
		<h3>Red Light Cameras Posted on <span id="datedisplay"></span></h3>
		<ul id="output"></ul>

		<script src="../lib/moment.min.js"></script>
		<script src="pikaday.js"></script>

		<script type="text/javascript">

			// API Documentation: https://github.com/dbushell/Pikaday

			var datepicker = document.getElementById('datepicker');

			var picker = new Pikaday({
				field: datepicker,
				disableWeekends: true,
				yearRange: [2004, 2010],
				bound: false,
				container: document.getElementById('container'),
				onSelect: function(){
					$.get('https://data.cityofchicago.org/resource/x3ag-h7gt.json', {
						go_live_date: datepicker.value
					}, listRedLightCameras);
				}
			});

			function listRedLightCameras(cameras, status){
				console.log(cameras, status);
				// STUB: output the intersection for each camera as an <li> in ul#output
				var output = document.getElementById('output');
				cameras.forEach(camera => {
					var li = document.createElement('li');
						li.innerText = camera.intersection;
						output.appendChild(li);
				});
				var datedisplay = document.getElementById('datedisplay');
					datedisplay.innerText = moment(picker.getDate()).format('dddd MMMM DD[th], YYYY');
			}

		</script>

		<script src="tests.js"></script>

	</body>
</html>